#!/usr/bin/env sh
set -eu

set -o pipefail

ROOT_DIR="$(cd "$(dirname "$0")/.." && pwd)"
cd "$ROOT_DIR/apps/server"

echo "[pre-push] Running ktlintFormat (strict mode)"
./gradlew ktlintFormat

echo "[pre-push] Ensure formatter changes are committed"
if ! git diff --exit-code --quiet; then
  echo "[pre-push] ktlintFormat modified files. Please commit formatter results first."
  exit 1
fi

echo "[pre-push] Running ktlintCheck"
./gradlew ktlintCheck
